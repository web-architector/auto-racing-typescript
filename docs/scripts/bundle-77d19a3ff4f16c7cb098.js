!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="./",o(o.s=4)}([function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gameOverBtn=t.videoBackground=t.myCar=t.gameRoad=t.game=t.score=t.startBtn=void 0,t.startBtn=document.createElement("button"),t.startBtn.classList.add("start","start__btn"),t.startBtn.innerText="Start",t.score=document.querySelector(".score"),t.game=document.querySelector(".game"),t.gameRoad=document.querySelector(".gameRoad"),t.myCar=document.createElement("div"),t.myCar.classList.add("my-car"),t.videoBackground=document.querySelector(".video"),t.videoBackground.playbackRate=1;t.gameOverBtn=(()=>{const e=document.createElement("button");return e.classList.add("game-over__btn"),e.innerHTML="<p>Game over</p><p>New game?</p><p>Yes/No</p>",e})()},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setStyles=t.SETTINGS=t.EXPLOSIVE_WIDTH=t.COMPETITORS_COUNT=t.TRAFFIC_LANES=t.MARKING_HEIGHT=t.MARKING_WIDTH=t.VEHICLE_HEIGHT=t.VEHICLE_WIDTH=t.ROAD_WIDTH=void 0;const n=o(0);t.ROAD_WIDTH=500,t.VEHICLE_WIDTH=50,t.VEHICLE_HEIGHT=100,t.MARKING_WIDTH=10,t.MARKING_HEIGHT=4*t.MARKING_WIDTH,t.TRAFFIC_LANES=6,t.COMPETITORS_COUNT=6,t.EXPLOSIVE_WIDTH=75,t.SETTINGS={start:!1,score:0,flowSpeed:5,traffic:3,maxCompetitorsViews:5,paused:!1,backgroundVideo:!0,audio:!0,x:0,y:0},t.setStyles=()=>{const e=n.gameRoad.style;e.setProperty("--roadWidth",t.ROAD_WIDTH+"px"),e.setProperty("--vehicleWidth",t.VEHICLE_WIDTH+"px"),e.setProperty("--vehicleHeight",t.VEHICLE_HEIGHT+"px"),e.setProperty("--markingWidth",t.MARKING_WIDTH+"px"),e.setProperty("--markingHeight",t.MARKING_HEIGHT+"px"),e.setProperty("--explosive-width",t.EXPLOSIVE_WIDTH+"px")}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomIntRange=t.randomRange=t.getElementQuantity=void 0,t.getElementQuantity=e=>document.documentElement.clientHeight/e+1,t.randomRange=(e,t)=>Math.random()*(t-e)+e,t.randomIntRange=(e,t)=>{let o=e+Math.random()*(t+1-e);return Math.floor(o)}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleAudio=t.audio=void 0;const n=o(1);t.audio=new Audio,t.audio.src="assets/audio/audio.mp3",t.audio.loop=!0,t.handleAudio=(e=!1)=>{n.SETTINGS.audio&&!e?t.audio.play().then():t.audio.pause()}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o(5),o(12)},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.playGame=void 0;const n=o(0),r=o(1),a=o(6),i=o(2),d=o(8),s=o(9),c=o(3),l=o(10),u=o(11);t.playGame=(e,o)=>{r.SETTINGS.paused?c.handleAudio(!0):(u.handleScore(),a.handleVehicleMove(),d.handleCompetitorsMove(e),s.handleEnvironmentMove(o),c.handleAudio()),l.handlevideoBackground();const n=requestAnimationFrame(()=>t.playGame(e,o));!r.SETTINGS.start&&cancelAnimationFrame(n)};const S=()=>{n.startBtn.classList.add("hide"),n.myCar.classList.remove("explosive"),n.gameOverBtn.classList.add("hide"),r.SETTINGS.start=!0,r.SETTINGS.paused=!1,r.SETTINGS.x=n.myCar.offsetLeft,r.SETTINGS.y=n.myCar.offsetHeight;const e=s.initAxialMarking(i.getElementQuantity(r.MARKING_HEIGHT)),o=d.initCompetitors(i.getElementQuantity(r.VEHICLE_HEIGHT*r.SETTINGS.traffic));requestAnimationFrame(()=>t.playGame(o,e))};n.gameRoad.append(n.myCar),s.initAxialMarking(150),n.startBtn.addEventListener("click",S),n.gameRoad.append(n.startBtn),n.score.innerHTML="SCORE: "+r.SETTINGS.score,a.setEventListeners(),r.setStyles()},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleVehicleMove=t.controlKeys=t.setEventListeners=void 0;const n=o(0),r=o(1),a=o(7);t.setEventListeners=()=>{document.addEventListener("keydown",i),document.addEventListener("keyup",d),n.gameOverBtn.addEventListener("click",a.gameOver)};const i=e=>{const o=e.key,i=e.code;if(t.controlKeys.hasOwnProperty(o)&&(e.preventDefault(),t.controlKeys[o]=!0),"Space"===i&&(r.SETTINGS.paused=!r.SETTINGS.paused,r.SETTINGS.backgroundVideo=!r.SETTINGS.backgroundVideo,e.preventDefault()),"KeyM"===i&&(r.SETTINGS.audio=!r.SETTINGS.audio),"KeyY"===i){if(r.SETTINGS.paused||r.SETTINGS.start)return;a.gameOver()}if("KeyS"===i){if(r.SETTINGS.score)return;n.startBtn.click()}"KeyB"===i&&(r.SETTINGS.backgroundVideo=!r.SETTINGS.backgroundVideo),"NumpadAdd"===i&&r.SETTINGS.flowSpeed<10&&r.SETTINGS.flowSpeed++,"NumpadSubtract"===i&&r.SETTINGS.flowSpeed>1&&r.SETTINGS.flowSpeed--},d=e=>{const o=e.key;e.preventDefault(),t.controlKeys.hasOwnProperty(o)&&(e.preventDefault(),t.controlKeys[o]=!1)};t.controlKeys={ArrowLeft:!1,ArrowRight:!1,ArrowDown:!1,ArrowUp:!1},t.handleVehicleMove=()=>{const{ArrowLeft:e,ArrowRight:o,ArrowUp:a,ArrowDown:i}=t.controlKeys;if(e){const e=r.SETTINGS.x-r.SETTINGS.flowSpeed;r.SETTINGS.x=e>0?e:0}if(o){const e=r.SETTINGS.x+r.SETTINGS.flowSpeed,t=n.gameRoad.offsetWidth-n.myCar.offsetWidth;r.SETTINGS.x=e>t?t:e}if(a){const e=r.SETTINGS.y+r.SETTINGS.flowSpeed,t=n.gameRoad.offsetHeight-n.myCar.offsetHeight;r.SETTINGS.y=e>t?t:e}if(i){const e=r.SETTINGS.y-r.SETTINGS.flowSpeed;r.SETTINGS.y=e>0?e:0}n.myCar.style.left=r.SETTINGS.x+"px",n.myCar.style.bottom=r.SETTINGS.y+"px"}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gameOver=void 0;const n=o(1),r=o(0);t.gameOver=()=>{n.SETTINGS.audio=!n.SETTINGS.audio,n.SETTINGS.score=0,r.startBtn.classList.remove("hide"),r.gameOverBtn.classList.add("hide")}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleCompetitorsMove=t.initCompetitors=void 0;const n=o(1),r=o(0),a=o(2),i=o(3);t.initCompetitors=e=>{const t=document.querySelectorAll(".competitor");console.log("###: Removed old competitors= ",t.length),t.forEach(e=>{var t;return null===(t=null==e?void 0:e.parentNode)||void 0===t?void 0:t.removeChild(e)});const o=[];for(let t=0;t<e;t++){const e=document.createElement("div");e.className="competitor";const a=-100*n.SETTINGS.traffic*(t+1);e.dataset.positionY=a.toString(),e.style.top=a+"px",d(e),r.gameRoad.append(e),o.push(e)}return o};const d=e=>{e.classList.remove("explosive"),e.style.left=((e,t,o)=>{const n=e/t,r=(n-o)/2;return a.randomIntRange(0,t-1)*n+r})(n.ROAD_WIDTH,n.TRAFFIC_LANES,n.VEHICLE_WIDTH)+"px",e.style.backgroundImage=`url('assets/images/competitor${a.randomIntRange(1,n.COMPETITORS_COUNT)}.png')`,e.dataset.currentSpeed=(n.SETTINGS.flowSpeed*a.randomRange(.7,1.3)).toString()},s=e=>{e.forEach(e=>{e.classList.add("explosive"),e.dataset.currentSpeed=n.SETTINGS.flowSpeed.toString()})},c=(e,t,o=.15*n.VEHICLE_WIDTH)=>{const r=e.getBoundingClientRect(),a=t.getBoundingClientRect();return r.bottom>0&&a.bottom>0&&r.top+o<a.bottom&&r.right-o>a.left&&r.left+o<a.right&&r.bottom-o>a.top};t.handleCompetitorsMove=e=>{e.forEach((t,o)=>{if(c(r.myCar,t))return console.log("###: Booom!!! My car crashed into "+o),s([t,r.myCar]),console.log("###: game over= ",666),r.gameOverBtn.classList.remove("hide"),n.SETTINGS.audio=!1,n.SETTINGS.start=!1,i.handleAudio(!0),void r.gameRoad.append(r.gameOverBtn);e.forEach((e,n)=>{o!==n&&c(t,e,0)&&(console.log(`###: Vehicle ${o} crashed into ${n}`),s([t,e]))});let a=parseInt(t.dataset.positionY)+parseInt(t.dataset.currentSpeed);t.dataset.positionY=a.toString(),a>=document.documentElement.clientHeight&&(a=-100,t.dataset.positionY=a.toString(),d(t)),t.style.top=a+"px"})}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleEnvironmentMove=t.initAxialMarking=void 0;const n=o(1),r=o(0);t.initAxialMarking=e=>{document.querySelectorAll(".marking").forEach(e=>{var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)});const t=[];for(let o=0;o<e;o++){const e=document.createElement("div");e.className="marking";const a=-5*n.MARKING_HEIGHT*1.5+o*n.MARKING_HEIGHT*1.5;e.style.top=a+"px",e.dataset.positionY=a.toString(),r.gameRoad.appendChild(e),t.push(e)}return t},t.handleEnvironmentMove=e=>{e.forEach(e=>{let t=parseInt(e.dataset.positionY)+n.SETTINGS.flowSpeed;e.dataset.positionY=t.toString(),t>=document.documentElement.clientHeight&&(t=-5*n.MARKING_HEIGHT*1.5,e.dataset.positionY=t.toString()),e.style.top=t+"px"})}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handlevideoBackground=void 0;const n=o(0),r=o(1);t.handlevideoBackground=()=>{r.SETTINGS.backgroundVideo?n.videoBackground.play():n.videoBackground.pause()}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleScore=void 0;const n=o(0),r=o(1);t.handleScore=()=>{r.SETTINGS.score+=r.SETTINGS.flowSpeed,n.score.innerHTML=`<span>SCORE: ${r.SETTINGS.score}</span><span>SPEED: ${r.SETTINGS.flowSpeed}</span>`}},function(e,t,o){}]);